{% extends 'base.html' %} {% load static %} {% block title %}Agri-Store -
Agri-Connect{% endblock %} {% block extra_css %}
<link rel="stylesheet" href="{% static 'css/store.css' %}" />
<style>
  /* Add modal styles here if not in external CSS */
  .category-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1000;
  }

  .modal-content {
    background-color: white;
    margin: 2% auto;
    padding: 2rem;
    width: 80%;
    max-width: 1200px;
    border-radius: 10px;
    position: relative;
  }

  .close-modal {
    position: absolute;
    right: 1.5rem;
    top: 1rem;
    font-size: 2rem;
    cursor: pointer;
  }

  .modal-products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-top: 1.5rem;
  }

  .modal-product-card {
    border: 1px solid #ddd;
    padding: 1rem;
    text-align: center;
  }
</style>
{% endblock %} {% block content %}
<section class="featured-products">
  <div class="section-header">
    <h2>Featured Products</h2>
    <a href="#" class="view-all"
      >View All <i class="fas fa-arrow-right" style="margin-left: 8px"></i
    ></a>
  </div>
  <div class="products-grid">
    <div class="product-card">
      <span class="sale-tag">Sale 50%</span>
      <div class="product-actions">
        <button class="action-btn wishlist-btn">
          <i class="fas fa-heart"></i>
        </button>
        <button class="action-btn cart-btn">
          <i class="fas fa-shopping-cart"></i>
        </button>
      </div>
      <img src="{% static 'images/amistar.jpeg' %}" alt="Amistar" />
      <div class="product-info">
        <h3>Amistar</h3>
        <div class="rating">
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star-half-alt"></i>
        </div>
        <div class="price">199</div>
      </div>
    </div>

    <div class="product-card">
      <div class="product-actions">
        <button class="action-btn wishlist-btn">
          <i class="fas fa-heart"></i>
        </button>
        <button class="action-btn cart-btn">
          <i class="fas fa-shopping-cart"></i>
        </button>
      </div>
      <img
        src="{% static 'images/products/hexa-force.png' %}"
        alt="Hexa Force"
      />
      <div class="product-info">
        <h3>Hexa Force</h3>
        <div class="rating">
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="far fa-star"></i>
        </div>
        <div class="price">149</div>
      </div>
    </div>

    <div class="product-card">
      <img src="{% static 'images/products/valipro.png' %}" alt="Valipro" />
      <div class="product-info">
        <h3>Valipro</h3>
        <div class="rating">
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star-half-alt"></i>
        </div>
        <div class="price">14.99</div>
        <button class="add-to-cart">
          <i class="fas fa-shopping-cart"></i>
        </button>
      </div>
    </div>

    <div class="product-card">
      <img src="{% static 'images/products/dimoxa.png' %}" alt="Dimoxa" />
      <div class="product-info">
        <h3>Dimoxa</h3>
        <div class="rating">
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="far fa-star"></i>
        </div>
        <div class="price">14.99</div>
        <button class="add-to-cart">
          <i class="fas fa-shopping-cart"></i>
        </button>
      </div>
    </div>
  </div>
</section>

<section class="categories">
  <div class="section-header">
    <h2>Shop by Top Categories</h2>
    <a href="#" class="view-all"
      >View All <i class="fas fa-arrow-right" style="margin-left: 8px"></i
    ></a>
  </div>
  <div class="categories-grid">
    <div class="category-card" data-category="herbicides">
      <i class="fas fa-leaf fa-2x" style="color: #00a651"></i>
      <h3>Herbicides</h3>
      <p>165 Products</p>
    </div>
    <div class="category-card" data-category="pesticides">
      <i class="fas fa-bug fa-2x" style="color: #00a651"></i>
      <h3>Pesticides</h3>
      <p>89 Products</p>
    </div>
    <div class="category-card" data-category="fertilizers">
      <i class="fas fa-seedling fa-2x" style="color: #00a651"></i>
      <h3>Fertilizers</h3>
      <p>76 Products</p>
    </div>
    <div class="category-card" data-category="seeds">
      <i class="fas fa-wheat-awn fa-2x" style="color: #00a651"></i>
      <h3>Seeds</h3>
      <p>165 Products</p>
    </div>
    <div class="category-card" data-category="machinery">
      <i class="fas fa-tractor fa-2x" style="color: #00a651"></i>
      <h3>Machinery</h3>
      <p>48 Products</p>
    </div>
    <div class="category-card" data-category="insecticides">
      <i class="fas fa-spider fa-2x" style="color: #00a651"></i>
      <h3>Insecticides</h3>
      <p>165 Products</p>
    </div>
  </div>
</section>

<!-- Category Modal -->
<div class="category-modal" id="categoryModal">
  <div class="modal-content">
    <span class="close-modal">&times;</span>
    <h3 class="modal-title">Products in <span id="categoryName"></span></h3>
    <div class="modal-products-grid"></div>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script>
  document.addEventListener("DOMContentLoaded", () => {
    // Enhanced product data
    const categories = {
      herbicides: [
        {
          name: "Weed Killer Pro",
          price: 24.99,
          image: "images/weedkiller.jpeg",
        },
        {
          name: "Herb Master",
          price: 19.99,
          image: "https://via.placeholder.com/200",
        },
      ],
      pesticides: [
        {
          name: "Bug Blaster",
          price: 29.99,
          image: "https://via.placeholder.com/200",
        },
        {
          name: "Pest Shield",
          price: 34.99,
          image: "https://via.placeholder.com/200",
        },
      ],
      fertilizers: [
        {
          name: "Growth Plus",
          price: 39.99,
          image: "https://via.placeholder.com/200",
        },
        {
          name: "Organic Mix",
          price: 44.99,
          image: "https://via.placeholder.com/200",
        },
      ],
    };

    // Modal elements
    const modal = document.getElementById("categoryModal");
    const closeBtn = document.querySelector(".close-modal");
    const modalTitle = document.getElementById("categoryName");
    const productsGrid = document.querySelector(".modal-products-grid");

    // Category click handler
    document.querySelectorAll(".category-card").forEach((card) => {
      card.addEventListener("click", () => {
        const category = card.dataset.category;
        if (categories[category]) {
          showCategoryProducts(category);
        } else {
          console.warn(`No products found for category: ${category}`);
        }
      });
    });

    // Modal close handlers
    closeBtn.addEventListener("click", () => (modal.style.display = "none"));
    window.addEventListener("click", (e) => {
      if (e.target === modal) modal.style.display = "none";
    });
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") modal.style.display = "none";
    });

    function showCategoryProducts(category) {
      productsGrid.innerHTML = "";
      modalTitle.textContent =
        category.charAt(0).toUpperCase() + category.slice(1);

      categories[category].forEach((product) => {
        const productCard = document.createElement("div");
        productCard.className = "modal-product-card";
        productCard.innerHTML = `
          <img src="${product.image}" alt="${
          product.name
        }" class="product-image">
          <h4>${product.name}</h4>
          <div class="price">$${product.price.toFixed(2)}</div>
        `;
        productsGrid.appendChild(productCard);
      });

      modal.style.display = "block";
    }

    // User menu dropdown
    const userIcon = document.getElementById("userIcon");
    const dropdownMenu = document.querySelector(".dropdown-menu");

    userIcon.addEventListener("click", () => {
      dropdownMenu.classList.toggle("show");
    });

    // Close dropdown when clicking outside
    window.addEventListener("click", (e) => {
      if (!e.target.matches("#userIcon")) {
        if (dropdownMenu.classList.contains("show")) {
          dropdownMenu.classList.remove("show");
        }
      }
    });

    // Initialize wishlist from localStorage
    let wishlist = JSON.parse(localStorage.getItem("wishlist") || "[]");

    // Function to update wishlist button state
    function updateWishlistButton(button, isInWishlist) {
      if (isInWishlist) {
        button.classList.add("active");
        button.querySelector("i").style.color = "#ff4444";
      } else {
        button.classList.remove("active");
        button.querySelector("i").style.color = "";
      }
    }

    // Function to get product data from card
    function getProductData(card) {
      const img = card.querySelector("img");
      const name = card.querySelector("h3").textContent;
      const price = card.querySelector(".price").textContent;
      const rating = card.querySelector(".rating").innerHTML;

      return {
        id: name.toLowerCase().replace(/\s+/g, "-"), // Create an ID from the name
        name: name,
        price: price,
        image: img.src,
        rating: rating,
      };
    }

    // Add click handlers to all wishlist buttons
    document.querySelectorAll(".wishlist-btn").forEach((button) => {
      const productCard = button.closest(".product-card");
      const productData = getProductData(productCard);

      // Set initial state
      const isInWishlist = wishlist.some((item) => item.id === productData.id);
      updateWishlistButton(button, isInWishlist);

      button.addEventListener("click", function () {
        const isCurrentlyInWishlist = wishlist.some(
          (item) => item.id === productData.id
        );

        if (isCurrentlyInWishlist) {
          // Remove from wishlist
          wishlist = wishlist.filter((item) => item.id !== productData.id);
          updateWishlistButton(button, false);
        } else {
          // Add to wishlist
          wishlist.push(productData);
          updateWishlistButton(button, true);
        }

        // Save to localStorage
        localStorage.setItem("wishlist", JSON.stringify(wishlist));
      });
    });
  });
</script>
{% endblock %}
